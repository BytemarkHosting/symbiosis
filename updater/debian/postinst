#!/bin/bash

set -e

#
# Skip, if we are not in "configure" state
#
if [ "$1" != "configure" ]; then
    echo "I: Skipping configuration"
    exit 0
fi

#
#  If we don't have a list then create one
#
if [ ! -e /etc/apt/sources.list.security ]; then
    cp /etc/apt/sources.list /etc/apt/sources.list.security
fi

#
#  Make sure we notify the local sysadmin
#
if [ ! -e /etc/symbiosis/updater ]; then
    echo "EMAIL=root" >/etc/symbiosis/updater
fi

#
#  remove old config file
#
if [ -e /etc/update-packages.conf ]; then
    rm /etc/update-packages.conf
fi

#
#  Remove old configuration file.
#
if [ -e /etc/cron.daily/cron-apt ]; then
    rm /etc/cron.daily/cron-apt
fi

#
#  Remove the old files we might have had present by accident
#
for i in /etc/cron.daily/update-packages /etc/cron.d/bytemark-vhost-updater /etc/cron.d/symbiosis-update ; do
    if [ -e $i ]; then
        rm -f $i ;
    fi
done


#DEBHELPER#
exit 0
